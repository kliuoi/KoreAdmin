{% extends "common/page.html.jinja2" %}

{# 标题 #}
{% block title %}登录 & 注册{% endblock %}


{# 这里放登录表单的HTML代码 #}
{% block amis_config %}
{
    "type": "page",
    {# "initApi": "/api/system/init", #}
    "title": "登录 & 注册",
    "body": {
        "type": "tabs",
        "tabs": [
            {
                "title": "登录",
                "tabClassName": "custom-tab-header",
                "body": {
                    "type": "form",
                    "mode": "horizontal",
                    "className": "custom-form",
                    "api": {
                        "method": "POST",
                        "url": "/system/auth/api/token",
                        "dataType": "form",
                    },
                    "redirect": "/system/index",
                    "controls": [
                        {
                        "type": "text",
                        "name": "email",
                        "required": true,
                        "placeholder": "请输入邮箱",
                        "label": "邮箱:"
                        },
                        {
                        "type": "password",
                        "name": "password",
                        "required": true,
                        "placeholder": "请输入密码",
                        "label": "密码:"
                        },
                        {
                        "type": "submit",
                        "label": "登录",
                        "level": "primary"
                        }
                    ]
                }
            },
            {
                "title": "注册",
                "tabClassName": "custom-tab-header",
                "body": {
                    "type": "form",
                    "mode": "horizontal",
                    "className": "custom-form",
                    "api": "/api/auth/register",
                    {# 提交后重置表单 #}
                    "resetAfterSubmit": true,
                    {# 提交后跳转到登录页面 #}
                    "redirect": "/auth/login",
                    "rules": [
                        {
                            "rule": "data.password == data.confirm_password",
                            "message": "两次密码输入不一致"
                        },
                    ],
                    "controls": [
                        {
                            "type": "input-email",
                            "name": "email",
                            "required": true,
                            "placeholder": "请输入邮箱",
                            "label": "邮箱:"
                            {# "validations": {
                                "isEmail": true
                            },
                            "validationErrors": {
                                "isEmail": "请输入正确的邮箱地址"
                            }, #}
                        },
                        {
                            "type": "password",
                            "name": "password",
                            "required": true,
                            "placeholder": "请输入密码",
                            "label": "密码:",
                            "description": "包含字母和数字",
                            "validations": {
                                "isAlphanumeric": true
                            },
                            "validationErrors": {
                                "isAlphanumeric": "必须是字母或者数字"
                            },
                        },
                        {
                            "type": "password",
                            "name": "confirm_password",
                            "required": true,
                            "placeholder": "请再次输入密码",
                            "label": "确认密码:",
                        },
                        {
                            "type": "input-text",
                            "name": "name",
                            "placeholder": "请输入昵称",
                            "label": "昵称:"
                        },
                        {
                            "type": "input-text",
                            "name": "phone",
                            "placeholder": "请输入手机号",
                            "label": "手机号:",
                            "validations": {
                                "isPhoneNumber": true
                            },
                            "validationErrors": {
                                "isPhoneNumber": "请输入正确的手机号码"
                            },
                        },
                        {
                            "type": "submit",
                            "label": "注册",
                            "level": "primary"
                        },
                    ],
                },
            },
        ],
    },
};
{% endblock %}
